import*as t from"@angular/core";import{input as e,effect as s,untracked as r,afterNextRender as n,inject as o,DestroyRef as i,Component as a,ChangeDetectionStrategy as h,NgModule as c}from"@angular/core";class u{constructor(t){this.host=t,this.config=e(null),this.mountParcel=e(null),this.onParcelMount=e(null),this.wrapWith=e("div"),this.customProps=e({}),this.appendTo=e(null),this.handleError=e(t=>console.error(t)),this.hasError=!1,this.wrapper=null,this.parcel=null,this.task=null,s(()=>{const t=this.customProps();r(()=>{this.scheduleTask("update",()=>{this.parcel?.update?.(t)})})}),n(()=>{this.scheduleTask("mount",()=>{this.wrapper=document.createElement(this.wrapWith());const t=this.appendTo();null!==t?t.appendChild(this.wrapper):this.host.nativeElement.appendChild(this.wrapper);const e=this.mountParcel();this.parcel=e(this.config(),{...this.customProps(),domElement:this.wrapper});const s=this.onParcelMount();return null!==s&&this.parcel.mountPromise.then(s),this.unmounted=!1,this.parcel.mountPromise})}),o(i).onDestroy(()=>{this.scheduleTask("unmount",()=>{if("MOUNTED"===this.parcel?.getStatus())return this.parcel.unmount()}),null!==this.wrapper&&this.wrapper.parentNode.removeChild(this.wrapper),this.unmounted=!0})}scheduleTask(t,e){this.hasError&&"unmount"!==t||(this.task=(this.task||Promise.resolve()).then(()=>{if(!this.unmounted||"unmount"===t)return e()}).catch(e=>{this.task=Promise.resolve(),this.hasError=!0,e?.message&&(e.message=`During '${t}', parcel threw an error: ${e.message}`);const s=this.handleError();throw"function"==typeof s?s(e):setTimeout(()=>{throw e}),e}))}static{this.ɵfac=function(e){return new(e||u)(t.ɵɵdirectiveInject(t.ElementRef))}}static{this.ɵcmp=t.ɵɵdefineComponent({type:u,selectors:[["parcel"]],inputs:{config:[1,"config"],mountParcel:[1,"mountParcel"],onParcelMount:[1,"onParcelMount"],wrapWith:[1,"wrapWith"],customProps:[1,"customProps"],appendTo:[1,"appendTo"],handleError:[1,"handleError"]},decls:0,vars:0,template:function(t,e){},encapsulation:2,changeDetection:0})}}class l{static{this.ɵfac=function(t){return new(t||l)}}static{this.ɵmod=t.ɵɵdefineNgModule({type:l})}static{this.ɵinj=t.ɵɵdefineInjector({})}}export{u as ParcelComponent,l as ParcelModule};
//# sourceMappingURL=single-spa-angular-parcel.min.js.map
